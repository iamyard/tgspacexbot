#!/bin/bash

# Ð˜Ð½Ñ‚ÐµÑ€Ð°ÐºÑ‚Ð¸Ð²Ð½Ð°Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð±Ð¾Ñ‚Ð°

echo "=========================================="
echo "ðŸ¤– ÐÐÐ¡Ð¢Ð ÐžÐ™ÐšÐ Ð›ÐžÐšÐÐ›Ð¬ÐÐžÐ“Ðž Ð‘ÐžÐ¢Ð"
echo "=========================================="
echo ""
echo "Ð”Ð»Ñ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ñ‚ÐµÑÑ‚Ð° Ð½ÑƒÐ¶ÐµÐ½ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð±Ð¾Ñ‚,"
echo "Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð½Ðµ ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚Ð¾Ð²Ð°Ñ‚ÑŒ Ñ Ð±Ð¾Ñ‚Ð¾Ð¼ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ."
echo ""
echo "Ð•ÑÐ»Ð¸ Ñƒ Ð²Ð°Ñ ÐµÑ‰Ðµ Ð½ÐµÑ‚ Ð±Ð¾Ñ‚Ð° Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð°:"
echo "1. ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ @BotFather Ð² Telegram"
echo "2. ÐžÑ‚Ð¿Ñ€Ð°Ð²ÑŒÑ‚Ðµ /newbot"
echo "3. Ð¡Ð»ÐµÐ´ÑƒÐ¹Ñ‚Ðµ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸ÑÐ¼"
echo "4. Ð¡ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ñ‚Ð¾ÐºÐµÐ½"
echo ""

read -p "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ñ‚Ð¾ÐºÐµÐ½ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð±Ð¾Ñ‚Ð° Ð´Ð»Ñ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ñ‚ÐµÑÑ‚Ð°: " NEW_TOKEN

if [ -z "$NEW_TOKEN" ]; then
    echo "âŒ Ð¢Ð¾ÐºÐµÐ½ Ð½Ðµ Ð²Ð²ÐµÐ´ÐµÐ½!"
    exit 1
fi

# ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ .env
cd "$(dirname "$0")"

if [ ! -f ".env" ]; then
    cat > .env << EOF
BOT_TOKEN=$NEW_TOKEN
CHANNEL_ID=@test_videcode
MINI_APP_URL=http://localhost:8000
EOF
else
    # ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ BOT_TOKEN
    if [[ "$OSTYPE" == "darwin"* ]]; then
        sed -i '' "s|BOT_TOKEN=.*|BOT_TOKEN=$NEW_TOKEN|" .env
    else
        sed -i "s|BOT_TOKEN=.*|BOT_TOKEN=$NEW_TOKEN|" .env
    fi
fi

echo ""
echo "âœ… Ð¢Ð¾ÐºÐµÐ½ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½ Ð² .env"
echo ""
echo "Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ Ð±Ð¾Ñ‚Ð°:"
echo "  ./start_bot.sh"
echo ""
